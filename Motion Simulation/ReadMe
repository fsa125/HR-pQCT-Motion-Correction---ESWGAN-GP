% =========================================================================
% The main.m script simulates synthetic motion in HR-pQCT scans.
%
% Usage Instructions:
% 1. Extract the HR-pQCT DICOM/ISQ files.
% 2. Move the motion-free images you want to use as ground truth (Ys)
%    into the `samples/input` directory (or the desired input folder).
% 3. In the main.m file, set `input_directory` to the folder containing the ground-truth images.
% 4. In the main.m file set `output_directory` to the folder where the motion-corrupted images
%    (Xs) will be saved.
% 5. Run "main.m"
% 
% The script processes the source ground-truth images and generates
% corresponding motion-degraded images, which are saved automatically in
% the specified output directory.
% =========================================================================


If you end up using some parts of this code, please cite:

@ARTICLE{11192748,
  author={Sadik, Farhan and Newman, Christopher L. and Warden, Stuart J. and Surowiec, Rachel K.},
  journal={IEEE Transactions on Radiation and Plasma Medical Sciences}, 
  title={Simulating Sinogram-Domain Motion and Correcting Image-Domain Artifacts Using Deep Learning in HR-pQCT Bone Imaging}, 
  year={2025},
  volume={},
  number={},
  pages={1-1},
  keywords={Motion artifacts;Bones;Imaging;Image reconstruction;Computed tomography;Translation;Generative adversarial networks;Signal to noise ratio;Mathematical models;Training;Bone;HR-pQCT;Motion;Sinogram;ESWGAN-GP;SNR;SSIM;VIF;Deep Learning},
  doi={10.1109/TRPMS.2025.3617225}}

W. van Aarle, W. J. Palenstijn, J. Cant, E. Janssens, F. Bleichrodt, A. Dabravolski, J. De Beenhouwer, K. J. Batenburg, and J. Sijbers, “Fast and Flexible X-ray Tomography Using the ASTRA Toolbox”, Optics Express, 24(22), 25129-25147, (2016), http://dx.doi.org/10.1364/OE.24.025129

W. van Aarle, W. J. Palenstijn, J. De Beenhouwer, T. Altantzis, S. Bals, K. J. Batenburg, and J. Sijbers, “The ASTRA Toolbox: A platform for advanced algorithm development in electron tomography”, Ultramicroscopy, 157, 35–47, (2015), http://dx.doi.org/10.1016/j.ultramic.2015.05.002

W. J. Palenstijn, K. J. Batenburg, and J. Sijbers, “Performance improvements for iterative electron tomography reconstruction using graphics processing units (GPUs)”, Journal of Structural Biology, vol. 176, issue 2, pp. 250-253, 2011, http://dx.doi.org/10.1016/j.jsb.2011.07.017

ASTRA Toolbox: https://github.com/astra-toolbox/astra-toolbox
